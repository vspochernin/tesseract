name: Deploy
on:
    push:
        branches: [ "master" ]
    pull_request:
        branches: [ "master" ]

jobs:
    build-and-deploy:
        runs-on: ubuntu-latest
        steps:
            -   name: Build and deploy
                uses: D3rHase/ssh-command-action@v0.2.2
                with:
                    host: ${{secrets.REMOTE_HOST}}
                    user: ${{secrets.REMOTE_USER}}
                    port: ${{secrets.REMOTE_PORT}}
                    private_key: ${{secrets.SSH_PRIVATE_KEY}}
                    command: |
                        cd ${{ secrets.REMOTE_TARGET }};
                        ls -la;
                        git pull;
                        docker ps;
                        docker-compose up -d --no-deps --build backend
                        docker ps;